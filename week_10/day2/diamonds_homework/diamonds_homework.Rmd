---
title: "R Notebook"
output: html_notebook
---

```{r}
library(tidyverse)
diamonds <- read_csv("diamonds.csv")
glimpse(diamonds)
```
```{r}
library(GGally)
ggpairs(diamonds)
```
```{r}
diamonds <- diamonds %>% 
  select(-x, -y, -z)

diamonds
```
```{r}
ggpairs(diamonds)
```
```{r}
diamonds %>% 
  ggplot(aes(x = carat, y = price)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)
```
```{r}
library(fastDummies)
```
```{r}
diamonds_dummy <- diamonds %>% 
  dummy_cols(select_columns = "cut", remove_first_dummy = TRUE,
             remove_selected_columns = TRUE) %>% 
  dummy_cols(select_columns = "clarity", remove_first_dummy = TRUE,
             remove_selected_columns = TRUE) %>% 
  dummy_cols(select_columns = "color", remove_first_dummy = TRUE,
             remove_selected_columns = TRUE) 

diamonds_dummy
```
```{r}
model <- lm(price~carat, data = diamonds)
summary(model)
```
```{r}
library(ggfortify)
autoplot(model)
```
```{r}
model <- lm(log(price) ~ log(carat), data = diamonds)
summary(model)
autoplot(model)
```
```{r}
model <- lm(log(price) ~ log(carat) + color, data = diamonds)
summary(model)
autoplot(model)
```





